{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2><i class="bi bi-file-earmark-text"></i> My Documents</h2>
        <div class="btn-group">
            <a href="{% url 'document_processing:shared_with_me' %}" class="btn btn-outline-info">
                <i class="bi bi-people-fill"></i> Shared with Me
            </a>
            <a href="{% url 'document_processing:upload' %}" class="btn btn-primary">
                <i class="bi bi-upload"></i> Upload New Document
            </a>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container position-fixed top-0 end-0 p-3"></div>
    
    <hr>
    {% if documents %}
    <div class="list-group">
        {% for document in documents %}
        <div class="list-group-item flex-column align-items-start">
            <div class="d-flex w-100 justify-content-between align-items-start">
                <div class="flex-grow-1">
                    <h5 class="mb-1">
                        <a href="{% url 'document_processing:document_detail' document.pk %}" class="text-decoration-none">
                            {{ document.title|default:"Untitled Document" }}
                        </a>
                    </h5>
                    <p class="mb-1">
                        Status:
                        <span class="badge rounded-pill 
                                    {% if document.status == 'PROCESSING' %}text-bg-warning
                                    {% elif document.status == 'COMPLETED' %}text-bg-success
                                    {% elif document.status == 'FAILED' %}text-bg-danger
                                    {% else %}text-bg-secondary{% endif %}">
                            {{ document.get_status_display }}
                        </span>
                    </p>
                    <small class="text-muted d-block">Source: {{ document.get_source_display }}</small>
                    <small class="text-muted">{{ document.created_at|date:"F d, Y" }}</small>
                </div>
                <div class="btn-group">
                    <a href="{% url 'document_processing:document_detail' document.pk %}" class="btn btn-sm btn-outline-primary">
                        <i class="bi bi-eye"></i> View
                    </a>
                    <button class="btn btn-sm btn-outline-info" 
                            onclick="openShareModal({{ document.pk }}, '{{ document.title|escapejs }}')"
                            type="button">
                        <i class="bi bi-share"></i> Share
                    </button>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-info" role="alert">
        You haven't uploaded any documents yet. Why not
        <a href="{% url 'document_processing:upload' %}" class="alert-link">upload your first one</a>?
    </div>
    {% endif %}
</div>

<!-- Include Share Modal -->
{% include "document_processing/document_share_modal.html" %}

{% endblock content %}